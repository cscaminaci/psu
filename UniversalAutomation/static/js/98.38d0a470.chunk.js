(this["webpackJsonppowershelluniversal.adminconsole"]=this["webpackJsonppowershelluniversal.adminconsole"]||[]).push([[98],{1329:function(e,n,t){"use strict";t.r(n);var r=t(49),c=t.n(r),i=t(86),a=t(0),u=t.n(a),o=t(43),s=t(1138),l=t(1139),f=t(1140),h=t(1141),b=t(441),d=t(74),w=t(438),m=t(924),p=t(122),v=t.n(p),k=t(22),g=t(4),j=new l.FitAddon,y=new f.SearchAddon,O=new s.WebLinksAddon;n.default=function(){var e=Object(o.i)().id,n=u.a.useRef(null),t=u.a.useRef(""),r=Object(o.h)(),s=Object(m.a)((function(){return v.a.post("/api/v1/terminal/instance/".concat(e))}),{onSuccess:function(e){k.a.refetchQueries("/terminal/instance",{stale:!0}),r("/admin/automation/terminals")}}).mutateAsync,l=(new b.a).withUrl("/terminalhub").withAutomaticReconnect().configureLogging(b.b.Debug).build(),f=u.a.useCallback(function(){var r=Object(i.a)(c.a.mark((function r(i){var a,u,o;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i.invoke("connect",Number.parseInt(e));case 2:a=r.sent,u=n.current.terminal,"success"!==a&&u.write("Failed to connect: "+a),o=function(){i.invoke("invoke","prompt").then((function(e){for(var n=0;n<e.length;n++)u.write("\b \b");u.write(e.trimEnd())}))},u.clear(),o(),n.current.terminal.onKey((function(e){if("\r"===e.key){if("cls"===t.current.toLocaleLowerCase()||"clear-host"===t.current.toLocaleLowerCase())return u.clear(),o(),void(t.current="");i.invoke("invoke",t.current).then((function(e){u.writeln(e),o(),t.current=""}))}if("\x1b"!==e.key)"\x7f"!==e.key?(n.current.terminal.write(e.key),t.current=t.current+e.key):t.current.length>0&&(t.current=t.current.substr(0,t.current.length-1),u.write("\b \b"));else if(t.current.length>0){for(var r=0;r<t.current.length;r++)u.write("\b \b");t.current=""}}));case 9:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),[n,e]);return Object(a.useEffect)((function(){var e=n.current;return j.fit(),l.start().then((function(){f(l)})).catch((function(e){n.current.terminal.write(e)})),n.current.terminal.writeln("Connecting..."),function(){return e.terminal.dispose()}}),[e,l,f]),Object(g.jsxs)("div",{className:"height100",children:[Object(g.jsx)(d.a,{icon:Object(g.jsx)(w.a,{}),danger:!0,onClick:function(){return s()},style:{float:"right"},children:"Exit"}),Object(g.jsx)(h.a,{ref:n,addons:[y,j,O],options:{cursorBlink:!0},className:"height100"})]})}}}]);
//# sourceMappingURL=98.38d0a470.chunk.js.map