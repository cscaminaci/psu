(window.webpackJsonpudmaterialize=window.webpackJsonpudmaterialize||[]).push([[2],{1295:function(t,e,n){"use strict";n.r(e),n.d(e,"default",(function(){return C}));var s=n(0),i=n.n(s),r=n(125),a=n(34),o=n.n(a),u=n(69),l=n(33),h=n(26),c=n.n(h),p=n(580),f=n.n(p),b=n(327);function v(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,s)}return n}function d(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(){return(m=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t}).apply(this,arguments)}function g(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function O(t,e){for(var n=0;n<e.length;n++){var s=e[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}function k(t,e,n){return e&&O(t.prototype,e),n&&O(t,n),t}function S(t,e){return!e||"object"!==y(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function j(t){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&w(t,e)}function w(t,e){return(w=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var C=function(t){function e(){var t;return g(this,e),(t=S(this,j(e).call(this))).state={hidden:!1},t}return E(e,t),k(e,[{key:"isGuid",value:function(t){if(null==t)return!1;"{"===t[0]&&(t=t.substring(1,t.length-1));return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}},{key:"componentWillMount",value:function(){this.isGuid(this.props.id)||(this.pubSubToken=o.a.subscribe(this.props.id,this.onIncomingEvent.bind(this)))}},{key:"onIncomingEvent",value:function(t,e){if("removeElement"===e.type){if("input"==this.props.tag)f()("#".concat(this.props.id))[0].parentElement.remove();this.setState({hidden:!0})}}},{key:"componentDidUpdate",value:function(){this.state.hidden&&null!=this.pubSubToken&&o.a.unsubscribe(this.pubSubToken)}},{key:"componentWillUnmount",value:function(){null!=this.pubSubToken&&o.a.unsubscribe(this.pubSubToken)}},{key:"render",value:function(){return this.state.hidden?null:i.a.createElement(P,m({key:this.props.id},this.props))}}]),e}(i.a.Component),P=function(t){function e(t){var n;return g(this,e),(n=S(this,j(e).call(this,t))).state={content:t.content,tag:t.tag,attributes:t.attributes,events:t.events,loading:!0,hasError:!1,errorMessage:""},n}return E(e,t),k(e,[{key:"loadData",value:function(){Object(u.b)("/api/internal/component/element/"+this.props.id,function(t){t.error?this.setState({hasError:!0,errorMessage:t.error.message}):this.setState({content:t,loading:!1})}.bind(this))}},{key:"componentDidCatch",value:function(t,e){this.setState({hasError:!0,errorMessage:t.message})}},{key:"componentWillMount",value:function(){this.pubSubToken=o.a.subscribe(this.props.id,this.onIncomingEvent.bind(this)),this.props.hasCallback?this.loadData():this.props.js?f.a.getScript(Object(l.a)()+"/api/internal/javascript/"+this.props.js,function(){this.setState({loading:!1})}.bind(this)):this.setState({loading:!1})}},{key:"onTextboxChanged",value:function(t){var e=t.target.value;this.state.attributes.value=e,this.setState({attributes:this.state.attributes})}},{key:"onCheckboxChanged",value:function(t){var e=t.target.value;e=t.target.checked,this.state.attributes.checked=e,this.setState({attributes:this.state.attributes});for(var n=0;n<this.state.events.length;n++)if("onChange"===this.state.events[n].event){var s=this.state.events[n];o.a.publish("element-event",{type:"clientEvent",eventId:s.id,eventName:"onChange",eventData:e})}}},{key:"componentWillUnmount",value:function(){if(!this.props.preventUnregister){if(null!=this.state.events)for(var t=0;t<this.state.events.length;t++)o.a.publish("element-event",{type:"unregisterEvent",eventId:this.state.events[t].id});this.props.hasCallback&&o.a.publish("element-event",{type:"unregisterEvent",eventId:this.props.id})}o.a.unsubscribe(this.pubSubToken)}},{key:"onIncomingEvent",value:function(t,e){if("setState"===e.type)this.setState(e.state);else if("requestState"===e.type)Object(u.c)("/api/internal/component/element/sessionState/".concat(e.requestId),this.state);else if("removeElement"===e.type)this.setState({hidden:!0});else if("addElement"===e.type){var n=this.state.content;null==n&&(n=[]),n=n.concat(e.elements),this.setState({content:n})}else"clearElement"===e.type?this.setState({content:null}):"syncElement"===e.type&&this.loadData()}},{key:"onUserEvent",value:function(t,e){var n=null,s=null;if("select"===this.state.tag){if(s=new Array,this.refs.element.selectedOptions){for(var i in this.refs.element.selectedOptions)if(!isNaN(i)){var r=this.refs.element.selectedOptions[i].value;s.push(r)}}else s.push(this.refs.element.value);s=1===s.length?s[0]:JSON.stringify(s);for(var a=0;a<this.state.events.length;a++)"onChange"===this.state.events[a].event&&(t=this.state.events[a]);n="onChange"}else n=t.event,null!=(s=e.target.value)&&null!=s.checked&&(s=e.target.checked);this.state.attributes.value=s,this.setState(this.state),o.a.publish("element-event",{type:"clientEvent",eventId:t.id,eventName:n,eventData:s})}},{key:"render",value:function(){if(this.state.hidden)return null;if(this.state.hasError)return i.a.createElement(b.a,{component:{type:"error",message:this.state.errorMessage}});if(this.props.error)return i.a.createElement(b.a,{component:{type:"error",message:this.state.errorMessage}});if(this.state.loading)return i.a.createElement("div",null);if(this.props.js)return Object(r.a)(function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?v(Object(n),!0).forEach((function(e){d(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({type:this.props.componentName},this.props.props),this.props.history);var t=null;this.state.content&&this.state.content.map?t=this.state.content.map(function(t){return null!=t.type?Object(r.a)(t,this.props.history):t}.bind(this)):this.state.content&&(t=Object(r.a)(this.state.content,this.props.history));var e=this.state.attributes;return null==e&&(e={}),null==e.id&&(e.id=this.props.id),null!=this.state.events&&this.state.events.map&&this.state.events.map(function(t){return e[t.event]=function(e){this.onUserEvent(t,e)}.bind(this),null}.bind(this)),"input"===this.state.tag&&("text"!==e.type&&"password"!==e.type||(e.onChange=this.onTextboxChanged.bind(this)),"checkbox"===e.type&&(e.onChange=this.onCheckboxChanged.bind(this))),"textarea"===this.state.tag&&(e.onChange=this.onTextboxChanged.bind(this)),e.ref="element",e.key=this.props.id,[i.a.createElement(this.state.tag,e,t),i.a.createElement(c.a,{timeout:1e3*this.props.refreshInterval,enabled:this.props.autoRefresh,callback:this.loadData.bind(this)})]}}]),e}(i.a.Component)}}]);
//# sourceMappingURL=ud-element.f81ca86a6e07279e1b38.bundle.map