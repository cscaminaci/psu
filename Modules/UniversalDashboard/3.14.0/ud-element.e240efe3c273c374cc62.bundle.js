"use strict";(self.webpackChunkmaterialui=self.webpackChunkmaterialui||[]).push([[12],{9891:(t,e,n)=>{n.r(e),n.d(e,{default:()=>m});var s=n(8489),i=n(7853),a=n(4531),r=n(8932),o=n(6621),h=n(7294),l=n(4593),u=n(1798),p=n.n(u),c=n(1305),v=n(6409),d=n.n(v),b=n(2239),m=function(t){(0,r.Z)(n,t);var e=(0,o.Z)(n);function n(){var t;return(0,i.Z)(this,n),(t=e.call(this)).state={hidden:!1},t}return(0,a.Z)(n,[{key:"isGuid",value:function(t){return null!=t&&("{"===t[0]&&(t=t.substring(1,t.length-1)),/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t))}},{key:"componentWillMount",value:function(){this.isGuid(this.props.id)||(this.pubSubToken=p().subscribe(this.props.id,this.onIncomingEvent.bind(this)))}},{key:"onIncomingEvent",value:function(t,e){"removeElement"===e.type&&("input"==this.props.tag&&$("#".concat(this.props.id))[0].parentElement.remove(),this.setState({hidden:!0}))}},{key:"componentDidUpdate",value:function(){this.state.hidden&&null!=this.pubSubToken&&p().unsubscribe(this.pubSubToken)}},{key:"componentWillUnmount",value:function(){null!=this.pubSubToken&&p().unsubscribe(this.pubSubToken)}},{key:"render",value:function(){return this.state.hidden?null:h.createElement(f,Object.assign({key:this.props.id},this.props))}}]),n}(h.Component),f=function(t){(0,r.Z)(n,t);var e=(0,o.Z)(n);function n(t){var s;return(0,i.Z)(this,n),(s=e.call(this,t)).state={content:t.content,tag:t.tag,attributes:t.attributes,events:t.events,loading:!0,hasError:!1,errorMessage:""},s}return(0,a.Z)(n,[{key:"loadData",value:function(){(0,c.Be)("/api/internal/component/element/"+this.props.id,function(t){t.error?this.setState({hasError:!0,errorMessage:t.error.message}):this.setState({content:t,loading:!1})}.bind(this))}},{key:"componentDidCatch",value:function(t){this.setState({hasError:!0,errorMessage:t.message})}},{key:"componentWillMount",value:function(){this.pubSubToken=p().subscribe(this.props.id,this.onIncomingEvent.bind(this)),this.props.hasCallback?this.loadData():this.setState({loading:!1})}},{key:"onTextboxChanged",value:function(t){var e=t.target.value;this.state.attributes.value=e,this.setState({attributes:this.state.attributes})}},{key:"onCheckboxChanged",value:function(t){var e,n,s=t.target.value;for(s=t.target.checked,this.state.attributes.checked=s,this.setState({attributes:this.state.attributes}),e=0;e<this.state.events.length;e++)"onChange"===this.state.events[e].event&&(n=this.state.events[e],p().publish("element-event",{type:"clientEvent",eventId:n.id,eventName:"onChange",eventData:s}))}},{key:"componentWillUnmount",value:function(){var t;if(!this.props.preventUnregister){if(null!=this.state.events)for(t=0;t<this.state.events.length;t++)p().publish("element-event",{type:"unregisterEvent",eventId:this.state.events[t].id});this.props.hasCallback&&p().publish("element-event",{type:"unregisterEvent",eventId:this.props.id})}p().unsubscribe(this.pubSubToken)}},{key:"onIncomingEvent",value:function(t,e){var n;"setState"===e.type?this.setState(e.state):"requestState"===e.type?(0,c.SD)("/api/internal/component/element/sessionState/".concat(e.requestId),this.state):"removeElement"===e.type?this.setState({hidden:!0}):"addElement"===e.type?(null==(n=this.state.content)&&(n=[]),n=n.concat(e.elements),this.setState({content:n})):"clearElement"===e.type?this.setState({content:null}):"syncElement"===e.type&&this.loadData()}},{key:"onUserEvent",value:function(t,e){var n,s,i=null,a=null;if("select"===this.state.tag){if(a=new Array,this.refs.element.selectedOptions)for(var r in this.refs.element.selectedOptions)isNaN(r)||(n=this.refs.element.selectedOptions[r].value,a.push(n));else a.push(this.refs.element.value);for(a=1===a.length?a[0]:JSON.stringify(a),s=0;s<this.state.events.length;s++)"onChange"===this.state.events[s].event&&(t=this.state.events[s]);i="onChange"}else{if("onKeyPress"===(i=t.event))return void p().publish("element-event",{type:"clientEvent",eventId:t.id,eventName:i,eventData:JSON.stringify({key:e.key,keyCode:e.keyCode})});null!=(a=e.target.value)&&null!=a.checked&&(a=e.target.checked)}this.state.attributes.value=a,this.setState(this.state),p().publish("element-event",{type:"clientEvent",eventId:t.id,eventName:i,eventData:a})}},{key:"render",value:function(){if(this.state.hidden)return null;if(this.state.hasError)return h.createElement(b.Z,{component:{type:"error",message:this.state.errorMessage}});if(this.props.error)return h.createElement(b.Z,{component:{type:"error",message:this.state.errorMessage}});if(this.state.loading)return h.createElement("div",null);if(this.props.js)return(0,l.Z)((0,s.Z)({type:this.props.componentName},this.props.props),this.props.history);var t=null;this.state.content&&this.state.content.map?this.state.content.length>0&&(t=this.state.content.map(function(t){return null!=t.type?(0,l.Z)(t,this.props.history):t}.bind(this))):this.state.content&&(t=this.state.content);var e=this.state.attributes;return null==e&&(e={}),null==e.id&&(e.id=this.props.id),null!=this.state.events&&this.state.events.map&&this.state.events.map(function(t){return e[t.event]=function(e){this.onUserEvent(t,e)}.bind(this),null}.bind(this)),"input"===this.state.tag&&("text"!==e.type&&"password"!==e.type||(e.onChange=this.onTextboxChanged.bind(this)),"checkbox"===e.type&&(e.onChange=this.onCheckboxChanged.bind(this))),"textarea"===this.state.tag&&(e.onChange=this.onTextboxChanged.bind(this)),e.ref="element",e.key=this.props.id,this.element=h.createElement(this.state.tag,e,t),[this.element,h.createElement(d(),{timeout:1e3*this.props.refreshInterval,enabled:this.props.autoRefresh,callback:this.loadData.bind(this)})]}}]),n}(h.Component)}}]);
//# sourceMappingURL=ud-element.1d95f66d7fc045544f3cd57ee257d435.bundle.map